@echo off
chcp 65001 >nul
setlocal EnableDelayedExpansion

title Bedtime Enforcer - ä¸¥æ ¼ä½œæ¯æ‰§è¡Œå™¨

:: æ£€æŸ¥ç®¡ç†å‘˜æƒé™
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo.
    echo [é”™è¯¯] éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è¿è¡Œæ­¤ç¨‹åº
    echo.
    echo è¯·å³é”®ç‚¹å‡»æ­¤æ–‡ä»¶ï¼Œé€‰æ‹© "ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"
    echo.
    pause
    exit /b 1
)

:MAIN_MENU
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                ðŸŒ™ Bedtime Enforcer for Windows               â•‘
echo â•‘                    ä¸¥æ ¼ä½œæ¯æ‰§è¡Œå™¨ v1.0                        â•‘
echo â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
echo â•‘                                                              â•‘
echo â•‘  è¿™ä¸ªå·¥å…·å°†å¸®åŠ©æ‚¨å»ºç«‹è§„å¾‹çš„ç¡çœ ä¹ æƒ¯ï¼š                          â•‘
echo â•‘  â€¢ åœ¨ç¡è§‰æ—¶é—´ï¼ˆ22:30ï¼‰è‡ªåŠ¨å…³æœº                                â•‘
echo â•‘  â€¢ åœ¨èµ·åºŠæ—¶é—´ï¼ˆ06:30ï¼‰è‡ªåŠ¨å¼€æœº                                â•‘
echo â•‘  â€¢ é˜²æ­¢åœ¨ç¡çœ æ—¶é—´æ®µä½¿ç”¨ç”µè„‘                                    â•‘
echo â•‘                                                              â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo è¯·é€‰æ‹©æ“ä½œï¼š
echo.
echo  [1] å¯ç”¨ä¸¥æ ¼ä½œæ¯æ¨¡å¼   (Enable)
echo  [2] ç¦ç”¨ä¸¥æ ¼ä½œæ¯æ¨¡å¼   (Disable)  
echo  [3] æŸ¥çœ‹å½“å‰çŠ¶æ€       (Status)
echo  [4] æµ‹è¯•è­¦å‘Šå¯¹è¯æ¡†     (Test)
echo  [5] æ‰“å¼€PowerShellè„šæœ¬ç›®å½•
echo  [6] æŸ¥çœ‹å¸®åŠ©è¯´æ˜Ž
echo  [0] é€€å‡ºç¨‹åº
echo.
echo âš ï¸  è­¦å‘Šï¼šæ­¤ç¨‹åºä¼šåœ¨è®¾å®šæ—¶é—´å¼ºåˆ¶å…³æœºæ‚¨çš„è®¡ç®—æœºï¼
echo âš ï¸  ä½¿ç”¨å‰è¯·åŠ¡å¿…ä¿å­˜é‡è¦å·¥ä½œã€‚
echo.

set /p choice="è¯·è¾“å…¥é€‰é¡¹ (0-6): "

if "%choice%"=="1" goto ENABLE
if "%choice%"=="2" goto DISABLE
if "%choice%"=="3" goto STATUS
if "%choice%"=="4" goto TEST
if "%choice%"=="5" goto OPEN_FOLDER
if "%choice%"=="6" goto HELP
if "%choice%"=="0" goto EXIT
goto INVALID_CHOICE

:ENABLE
cls
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  å¯ç”¨ä¸¥æ ¼ä½œæ¯æ¨¡å¼
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo æ­£åœ¨å¯ç”¨ä¸¥æ ¼ä½œæ¯æ¨¡å¼...
echo.
powershell.exe -ExecutionPolicy Bypass -File "%~dp0bedtime_enforcer.ps1" -Action enable
echo.
echo æŒ‰ä»»æ„é”®è¿”å›žä¸»èœå•...
pause >nul
goto MAIN_MENU

:DISABLE
cls
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  ç¦ç”¨ä¸¥æ ¼ä½œæ¯æ¨¡å¼
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo æ­£åœ¨ç¦ç”¨ä¸¥æ ¼ä½œæ¯æ¨¡å¼...
echo.
powershell.exe -ExecutionPolicy Bypass -File "%~dp0bedtime_enforcer.ps1" -Action disable
echo.
echo æŒ‰ä»»æ„é”®è¿”å›žä¸»èœå•...
pause >nul
goto MAIN_MENU

:STATUS
cls
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  å½“å‰çŠ¶æ€
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
powershell.exe -ExecutionPolicy Bypass -File "%~dp0bedtime_enforcer.ps1" -Action status
echo.
echo æŒ‰ä»»æ„é”®è¿”å›žä¸»èœå•...
pause >nul
goto MAIN_MENU

:TEST
cls
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  æµ‹è¯•è­¦å‘Šå¯¹è¯æ¡†
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo è¿™å°†æ˜¾ç¤º5åˆ†é’Ÿè­¦å‘Šå¯¹è¯æ¡†ï¼ˆä»…æµ‹è¯•ï¼Œä¸ä¼šå…³æœºï¼‰
echo.
powershell.exe -ExecutionPolicy Bypass -File "%~dp0bedtime_enforcer.ps1" -Action test
echo.
echo æŒ‰ä»»æ„é”®è¿”å›žä¸»èœå•...
pause >nul
goto MAIN_MENU

:OPEN_FOLDER
explorer.exe "%~dp0"
goto MAIN_MENU

:HELP
cls
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  å¸®åŠ©è¯´æ˜Ž
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ðŸ“‹ é»˜è®¤é…ç½®ï¼š
echo   â€¢ ç¡è§‰æ—¶é—´ï¼š22:30 (æ™šä¸Š10ç‚¹30åˆ†)
echo   â€¢ èµ·åºŠæ—¶é—´ï¼š06:30 (æ—©ä¸Š6ç‚¹30åˆ†)
echo   â€¢ ç¦æ­¢æ—¶æ®µï¼š22:30 - 06:30
echo.
echo ðŸ”§ è‡ªå®šä¹‰è®¾ç½®ï¼š
echo   ç¼–è¾‘ bedtime_enforcer.ps1 æ–‡ä»¶é¡¶éƒ¨çš„é…ç½®å˜é‡
echo.
echo ðŸ› ï¸ å·¥ä½œåŽŸç†ï¼š
echo   1. ä½¿ç”¨Windowsä»»åŠ¡è®¡åˆ’ç¨‹åºè®¾ç½®å®šæ—¶å…³æœº
echo   2. åˆ›å»ºå¼€æœºæ£€æŸ¥ä»»åŠ¡é˜²æ­¢åœ¨ç¡çœ æ—¶é—´ä½¿ç”¨
echo   3. æ”¯æŒè‡ªåŠ¨å”¤é†’ï¼ˆéœ€è¦BIOSæ”¯æŒï¼‰
echo.
echo ðŸ“Š ä»»åŠ¡ç®¡ç†ï¼š
echo   å¯ä»¥åœ¨ "ä»»åŠ¡è®¡åˆ’ç¨‹åº" (taskschd.msc) ä¸­æŸ¥çœ‹å’Œç®¡ç†
echo.
echo ðŸŽ¯ ç”Ÿç‰©é’Ÿè°ƒæ•´å»ºè®®ï¼š
echo   1. æ¸è¿›å¼è°ƒæ•´ï¼šæ¯å¤©æå‰15åˆ†é’Ÿç¡è§‰
echo   2. åšæŒ21å¤©ä»¥ä¸Šå½¢æˆä¹ æƒ¯
echo   3. é…åˆçŽ¯å¢ƒä¼˜åŒ–ï¼ˆè°ƒæš—ç¯å…‰ã€å‡å°‘è“å…‰ç­‰ï¼‰
echo   4. å›ºå®šèµ·åºŠæ—¶é—´ï¼ŒåŒ…æ‹¬å‘¨æœ«
echo.
echo ðŸ” æ•…éšœæŽ’é™¤ï¼š
echo   â€¢ ç¡®ä¿ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
echo   â€¢ æ£€æŸ¥PowerShellæ‰§è¡Œç­–ç•¥
echo   â€¢ éªŒè¯BIOSä¸­çš„RTCå”¤é†’è®¾ç½®
echo.
echo ðŸ“„ è¯¦ç»†è¯´æ˜Žè¯·å‚è€ƒï¼šREADME_Windows.md
echo.
echo æŒ‰ä»»æ„é”®è¿”å›žä¸»èœå•...
pause >nul
goto MAIN_MENU

:INVALID_CHOICE
cls
echo.
echo [é”™è¯¯] æ— æ•ˆçš„é€‰é¡¹ï¼Œè¯·è¾“å…¥ 0-6 ä¹‹é—´çš„æ•°å­—
echo.
echo æŒ‰ä»»æ„é”®é‡æ–°é€‰æ‹©...
pause >nul
goto MAIN_MENU

:EXIT
cls
echo.
echo æ„Ÿè°¢ä½¿ç”¨ Bedtime Enforcerï¼
echo å¸Œæœ›è¿™ä¸ªå·¥å…·èƒ½å¸®åŠ©æ‚¨å»ºç«‹å¥åº·çš„ç¡çœ ä¹ æƒ¯ã€‚
echo.
echo è®°ä½ï¼šè‰¯å¥½çš„ç¡çœ æ˜¯å¥åº·ç”Ÿæ´»çš„åŸºç¡€ ðŸŒ™
echo.
echo ç¨‹åºå³å°†é€€å‡º...
timeout /t 3 /nobreak >nul
exit /b 0 